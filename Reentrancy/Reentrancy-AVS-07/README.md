## Vulnerable Code

```javascript
function lend(address to, ERC20 token, uint256 amount, address target, bytes data) public payable {
        uint256 prevBalance = token.balanceOf(this);
        token.asmTransfer(to, amount);
        _inLendingMode += 1;
        require(caller().makeCall.value(msg.value)(target, data), "lend: arbitrary call failed");  //Vulnerable position_1
        _inLendingMode -= 1;
        require(token.balanceOf(this) >= prevBalance, "lend: lended token must be refilled"); //Vulnerable position_2
}

```



## Exploit Code

```javascript

```



##  Sophisticated Vulnerability Description

